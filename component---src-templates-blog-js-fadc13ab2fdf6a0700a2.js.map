{"version":3,"sources":["webpack://galerie-gaia/./src/templates/blog.js"],"names":["Blog","scrollPosition","props","pageContext","frontmatter","pages","articles","ref","useRef","useState","history","state","values","setValues","categories","useMemo","Array","from","Set","map","article","reduce","acc","curr","options","type","filter","length","some","category","includes","value","label","isMulti","entities","Object","keys","every","key","reverse","usePagination","initial","page","setPage","pieces","useEffect","pushState","document","title","movePage","current","scrollIntoView","window","scrollTo","top","behavior","setTimeout","seo","description","image","heading","css","styles","element","results","index","Fragment","src","join","date","Date","toLocaleDateString","weekday","year","month","day","children","content","empty","disabled","onClick","direction","flex","padding","display","alignItems","justifyContent","margin","paddingRight","flexDirection","flexShrink","theme","minHeight","minWidth","maxWidth","height","maxHeight","objectFit","fontStyle","textDecoration","lineHeight","textAlign"],"mappings":"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","file":"component---src-templates-blog-js-fadc13ab2fdf6a0700a2.js","sourcesContent":["import { useEffect, Fragment, useMemo, useState, useRef } from 'react'\nimport usePagination from 'hooks/use-pagination'\nimport SEO from 'components/SEO'\nimport Layout from 'components/Layout'\nimport Icon from 'components/Icon'\nimport RichText from 'components/RichText'\nimport Image from 'components/Image'\nimport Heading from 'components/Heading'\nimport Options from 'components/Options'\nimport theme from 'theme'\n\nconst Blog = ({ scrollPosition, ...props }) => {\n  const { pageContext: { pages, frontmatter } } = props\n  const { articles } = frontmatter\n  const ref = useRef(null)\n  const [values, setValues] = useState((typeof history !== 'undefined' && history.state?.values) || {})\n\n  const categories = useMemo(() => Array.from(new Set(articles\n    .map(article => article.categories)\n    .reduce((acc, curr) => [...acc, ...(curr || [])], []))\n  ), [])\n\n  const options = useMemo(() => ({\n    categories: {\n      type: 'select',\n      filter: (article, categories) => !categories.length || categories.some(category => (article.categories || []).includes(category.value)),\n      props: {\n        label: `Catégories d'Actualité`,\n        isMulti: true,\n        options: categories.map(category => ({\n          value: category,\n          label: category,\n        })),\n      },\n    },\n  }), [])\n\n  const entities = useMemo(() => (articles\n    .filter(article => Object.keys(values).every(key => options[key].filter(article, values[key])))\n    .reverse()\n  ), [articles, values])\n\n  const { page, setPage, pieces, length } = usePagination(entities, 10, { initial: (typeof history !== 'undefined' && history.state?.page) || 0 })\n\n  useEffect(() => {\n    if (Object.keys(values).length || page > 0) {\n      history.pushState({ values, page }, document.title)\n    }\n  }, [values, page])\n\n  const movePage = (page) => {\n    if (ref.current) {\n      ref.current.scrollIntoView()\n    } else {\n      window.scrollTo({ top: 0, behavior: 'smooth' })\n    }\n\n    setTimeout(() => {\n      setPage(page)\n    }, 1000)\n  }\n\n  return (\n    <Layout {...props}>\n      <SEO\n        title={frontmatter.seo.title}\n        description={frontmatter.seo.description}\n        image={pieces[0]?.image}\n        pageContext={props.pageContext}\n      />\n      <Heading>{frontmatter.seo.heading}</Heading>\n      <section ref={ref} css={Blog.styles.element}>\n        <Heading>{frontmatter.seo.heading}</Heading>\n        <Options options={options} setPage={setPage} values={values} setValues={setValues} />\n        <div css={Blog.styles.results}>\n          {pieces.map((article, index) => (\n            <Fragment key={article.title}>\n              <article css={Blog.styles.article}>\n                <Image src={article.image} />\n                <div>\n                  <h2>{article.title}</h2>\n                  <p>\n                    {article.categories.join(', ')}\n                    {!!article.date ? ` - ${new Date(article.date).toLocaleDateString('fr-FR', { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' })}` : ''}\n                  </p>\n                  <RichText children={article.content} />\n                </div>\n              </article>\n              <hr />\n            </Fragment>\n          ))}\n          {!pieces.length && (\n            <div css={Blog.styles.empty}>\n              Désolé, aucune oeuvres ne correspond à vos critères pour le moment\n            </div>\n          )}\n        </div>\n        {length > 1 && (\n          <nav>\n            <button disabled={page === 0} onClick={() => movePage(page - 1)}>\n              <Icon children=\"arrow\" direction=\"left\" />\n            </button>\n            <span>{page + 1} / {length}</span>\n            <button disabled={(page + 1) === length} onClick={() => movePage(page + 1)}>\n              <Icon children=\"arrow\" direction=\"right\" />\n            </button>\n          </nav>\n        )}\n      </section>\n    </Layout>\n  )\n}\n\nBlog.styles = {\n  element: {\n    flex: 1,\n    padding: '2em',\n    '>nav': {\n      display: 'flex',\n      alignItems: 'center',\n      justifyContent: 'center',\n      padding: '0 0 2em',\n      '>button': {\n        display: 'flex',\n        alignItems: 'center',\n        justifyContent: 'center',\n        margin: '0 1rem',\n        paddingRight: '0.33em',\n      },\n    },\n  },\n  results: {\n    display: 'flex',\n    flexDirection: 'column',\n    flex: 1,\n    padding: '2em 2em 0',\n  },\n  article: {\n    flexShrink: 0,\n    display: 'flex',\n    flexDirection: 'row',\n    alignItems: 'flex-start',\n    [theme.medias.small]: {\n      flexDirection: 'column',\n    },\n    '>span': {\n      flex: 0,\n      alignItems: 'center',\n      minHeight: '20rem',\n      minWidth: '15rem',\n      maxWidth: '50%',\n      [theme.medias.small]: {\n        flex: 1,\n        height: '15rem',\n        maxHeight: 'unset',\n        minWidth: 'unset',\n        maxWidth: 'unset',\n        margin: '0 0 2rem 0',\n      },\n      '>img': {\n        objectFit: 'contain',\n      },\n    },\n    '>div': {\n      flex: 1,\n      display: 'flex',\n      flexDirection: 'column',\n      margin: '0 0 0 2rem',\n      [theme.medias.small]: {\n        margin: 0,\n      },\n      '>p': {\n        margin: 0,\n        fontStyle: 'italic',\n        textDecoration: 'underline',\n      },\n      '>div': {\n        lineHeight: '1.5',\n      },\n    },\n  },\n  empty: {\n    display: 'flex',\n    alignItems: 'center',\n    justifyContent: 'center',\n    padding: '4em 0',\n    textAlign: 'center',\n  },\n}\n\nexport default Blog\n"],"sourceRoot":""}